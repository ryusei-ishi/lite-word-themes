"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.registerEntityAction = registerEntityAction;
exports.registerPostTypeActions = void 0;
exports.setIsReady = setIsReady;
exports.unregisterEntityAction = unregisterEntityAction;
var _coreData = require("@wordpress/core-data");
var _hooks = require("@wordpress/hooks");
var _deletePost = _interopRequireDefault(require("../actions/delete-post"));
var _exportPattern = _interopRequireDefault(require("../actions/export-pattern"));
var _resetPost = _interopRequireDefault(require("../actions/reset-post"));
var _trashPost = _interopRequireDefault(require("../actions/trash-post"));
var _permanentlyDeletePost = _interopRequireDefault(require("../actions/permanently-delete-post"));
var _restorePost = _interopRequireDefault(require("../actions/restore-post"));
var _store = require("../../store");
var _lockUnlock = require("../../lock-unlock");
/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */

function registerEntityAction(kind, name, config) {
  return {
    type: 'REGISTER_ENTITY_ACTION',
    kind,
    name,
    config
  };
}
function unregisterEntityAction(kind, name, actionId) {
  return {
    type: 'UNREGISTER_ENTITY_ACTION',
    kind,
    name,
    actionId
  };
}
function setIsReady(kind, name) {
  return {
    type: 'SET_IS_READY',
    kind,
    name
  };
}
const registerPostTypeActions = postType => async ({
  registry
}) => {
  const isReady = (0, _lockUnlock.unlock)(registry.select(_store.store)).isEntityReady('postType', postType);
  if (isReady) {
    return;
  }
  (0, _lockUnlock.unlock)(registry.dispatch(_store.store)).setIsReady('postType', postType);
  const postTypeConfig = await registry.resolveSelect(_coreData.store).getPostType(postType);
  const actions = [postTypeConfig.slug === 'wp_block' ? _exportPattern.default : undefined, _resetPost.default, _restorePost.default, _deletePost.default, _trashPost.default, _permanentlyDeletePost.default];
  registry.batch(() => {
    actions.forEach(action => {
      if (action === undefined) {
        return;
      }
      (0, _lockUnlock.unlock)(registry.dispatch(_store.store)).registerEntityAction('postType', postType, action);
    });
  });
  (0, _hooks.doAction)('core.registerPostTypeActions', postType);
};
exports.registerPostTypeActions = registerPostTypeActions;
//# sourceMappingURL=private-actions.js.map